## JVM常用内存调优命令

几个常用的命令，分别为**jps，jinfo，jstack，jmap以及jstat命令**。

- **jps：**主要用来输出JVM中运行的**进程状态信息**，一般使用jps命令来查看进程的状态信息，包括JVM启动参数等。
- **jinfo：**主要用来观察进程**运行环境参数**等信息。
- **jstack：**主要用来查看某个Java进程内的**线程堆栈信息**。jstack pid 可以看到当前进程中各个线程的状态信息，包括其持有的锁和等待的锁。
- **jmap：**用来查看**堆内存使用状况**。jmap -heap pid可以看到当前进程的堆信息和使用的GC收集器，包括年轻代和老年代的大小分配等。
- **jstat：**进行**实时命令行**的监控，包括**堆信息以及实时GC信息**等。可以使用jstat -gcutil pid1000来每隔一秒来查看当前的GC信息。



**如何排查一个线上的服务异常？**

- 首先查看当前进程的JVM启动参数，查看内存设置是否存在明显问题。
- 查看GC日志，看GC频率和时间是否明显异常。
- 查看当前进程的状态信息top -Hp pid，包括线程个数等信息。
- jstack pid查看当前的线程状态，是否存在死锁等关键信息。
- jstat -gcutil pid查看当前进程的GC情况。
- jmap -heap pid查看当前进程的堆信息，包括使用的垃圾收集器等信息。
- 用jvisiual工具打开dump二进制文件，分析是什么对象导致了内存泄漏，定位到代码处，进行code review。